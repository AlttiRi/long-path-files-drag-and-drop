<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Image Drag and Drop â€” Demo App</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            min-height: 100vh;
            margin: 0;
            background-color: #f5f5f5;
            padding-top: 40px;
        }

        #drop-zone {
            width: 500px;
            height: 200px;
            border: 3px dashed #aaa;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            /*transition: all 0.3s ease;*/
            cursor: pointer;
            font-size: 20px;
            background-color: #fff;
        }

        #drop-zone.hover {
            box-shadow: 0 0 25px rgba(0, 123, 255, 0.6);
            border-color: #007bff;
            background-color: #eef5ff;
        }

        #gallery {
            margin-top: 40px;
            display: flex;
            flex-wrap: wrap;
            gap: 25px;
            justify-content: center;
            padding: 0 20px;
        }

        .image-item {
            width: 260px;
            border: 1px solid #ddd;
            border-radius: 12px;
            background-color: white;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .image-container {
            width: 100%;
            height: 220px;
            background-color: #f0f0f0;
            overflow: hidden;
        }

        .image-container img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        .info-container {
            padding: 14px;
            font-size: 14px;
        }

        .filename {
            font-weight: 500;
            word-break: break-word;
            overflow-wrap: break-word;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
            line-height: 1.4;
            height: 60px;
        }
    </style>
</head>
<body>
<div id="drop-zone">
    <p>Drop images here</p>
</div>
<div id="gallery"></div>

<script>
    const dropZone = document.getElementById("drop-zone");
    const gallery = document.getElementById("gallery");

    function preventDefaults(e) {
        e.preventDefault();
        e.stopPropagation();
    }

    ["dragenter", "dragover", "dragleave", "drop"].forEach(eventName => {
        document.addEventListener(eventName, preventDefaults);
        dropZone.addEventListener(eventName, preventDefaults);
    });

    ["dragenter", "dragover"].forEach(eventName => {
        dropZone.addEventListener(eventName, () => {
            dropZone.classList.add("hover");
        });
    });

    ["dragleave", "drop"].forEach(eventName => {
        dropZone.addEventListener(eventName, () => {
            dropZone.classList.remove("hover");
        });
    });

    dropZone.addEventListener("drop", handleDrop);

    function handleDrop(e) {
        const files = e.dataTransfer.files;
        for (let file of files) {
            if (file.type.startsWith("image/")) {
                displayImage(file);
            }
            console.log(file);
        }
    }

    /** @param {File} file */
    function displayImage(file) {
        const url = URL.createObjectURL(file);
        setTimeout(() => URL.revokeObjectURL(url), 60_000);

        const imgContainer = document.createElement("div");
        imgContainer.className = "image-container";

        const img = document.createElement("img");
        img.src = url;
        imgContainer.append(img);

        const size = formatFileSizeWinLike(file.size);
        const formattedDate = formatDate(file.lastModified, "YYYY-MM-DD hh:mm:ss");

        const infoContainer = document.createElement("div");
        infoContainer.className = "info-container";
        infoContainer.innerHTML = `
            <p><strong>Name:</strong><span class="filename">${file.name}</span></p>
            <p><strong>Size:</strong> ${size}</p>
            <p><strong>Date:</strong> ${formattedDate}</p>
        `.trim();

        const item = document.createElement("div");
        item.className = "image-item";
        item.append(imgContainer);
        item.append(infoContainer);

        gallery.append(item);
    }

    /**
     * Formats date. Supports: YY.YYYY.MM.DD hh:mm:ss.
     * Default format: "YYYY.MM.DD".
     * formatDate() -> "2022.01.07"
     * @param {Date | string | number} [dateValue]
     * @param {string}  [pattern = "YYYY.MM.DD"]
     * @param {boolean} [utc = true]
     * @return {string}
     */
    function formatDate(dateValue = new Date(), pattern = "YYYY.MM.DD", utc = true) {
        dateValue = firefoxDateFix(dateValue);
        const date = new Date(dateValue);
        if (date.toString() === "Invalid Date") {
            console.warn("Invalid Date value: ", dateValue);
        }
        const formatter = new DateFormatter(date, utc);
        return pattern.replaceAll(/YYYY|YY|MM|DD|HH|hh|mm|SS|ss/g, (...args) => {
            const property = args[0];
            return formatter[property];
        });
    }
    function firefoxDateFix(dateValue) {
        if (isString(dateValue)) {
            return dateValue.replace(/(?<y>\d{4})\.(?<m>\d{2})\.(?<d>\d{2})/, "$<y>-$<m>-$<d>");
        }
        return dateValue;
    }
    function pad0(value, count = 2) {
        return value.toString().padStart(count, "0");
    }
    class DateFormatter {
        constructor(date = new Date(), utc = true) {
            this.date = date;
            this.utc = utc ? "UTC" : "";
        }
        get SS() {
            console.log("SS is deprecated. Use ss.");
            return pad0(this.date[`get${this.utc}Seconds`]());
        }
        get ss() { return pad0(this.date[`get${this.utc}Seconds`]()); }
        get mm() { return pad0(this.date[`get${this.utc}Minutes`]()); }
        get HH() {
            console.log("HH is deprecated. Use hh.");
            return pad0(this.date[`get${this.utc}Hours`]());
        }
        get hh() { return pad0(this.date[`get${this.utc}Hours`]()); }
        get MM() { return pad0(this.date[`get${this.utc}Month`]() + 1); }
        get DD() { return pad0(this.date[`get${this.utc}Date`]()); }
        get YYYY() { return pad0(this.date[`get${this.utc}FullYear`](), 4); }
        get YY() { return this.YYYY.slice(2); }
    }
    function isString(value) {
        return typeof value === "string";
    }

    const sizes = ["B", "KB", "MB", "GB", "TB", "PB", "EB", "ZB", "YB"];
    /**
     * Formats bytes EXACTLY like Windows File Explorer does.
     */
    function formatFileSizeWinLike(bytes) {
        if (bytes < 1024) {
            return bytes + " B";
        }
        let i = 0;
        let result = bytes;
        while (result >= 1000) {
            i++;
            result = Math.trunc(result) / 1024;
        }
        return toTruncPrecision3(result) + " " + sizes[i];
    }
    function toTruncPrecision3(number) {
        if (number >= 100) {
            return Math.trunc(number).toString();
        }
        else if (number >= 10) {
            return (Math.trunc(number * 10) / 10).toFixed(1);
        }
        else if (number >= 0.01) {
            return (Math.trunc(number * 100) / 100).toFixed(2);
        }
        else {
            return "0";
        }
    }
</script>
</body>
</html>